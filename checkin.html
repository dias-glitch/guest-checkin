<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ </title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: sans-serif;
      background-color: #f0f2f5;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }

    .checkin-box {
      background-color: white;
      padding: 30px 25px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      width: 100%;
      max-width: 420px;
      box-sizing: border-box;
      position: relative;
    }

    .lang-box {
      position: absolute;
      top: 10px;
      right: 10px;
    }

    .lang-box select {
      font-size: 14px;
      padding: 4px 8px;
      border-radius: 5px;
      background-color: #f2f2f2;
      border: 1px solid #ccc;
    }

    h2 {
      text-align: center;
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-top: 15px;
      font-size: 15px;
    }

    input,
    select {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      border-radius: 5px;
      border: 1px solid #ccc;
      margin-top: 5px;
      box-sizing: border-box;
    }

    .gender-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top:5px;
      justify-content: flex-start;
      
    }

    .gender-row label {
      display: flex;
      align-items: center;
      font-size: 14px;
      white-space:nowrap;
    }
    .gender-row input{
      margin-right:3px;
    }
    
    button {
      width: 100%;
      background-color: blue;
      color: white;
      padding: 12px;
      font-size: 16px;
      border: none;
      border-radius: 5px;
      margin-top: 25px;
      cursor: pointer;
    }

    button:hover {
      background-color: darkblue;
    }

    #message {
      text-align: center;
      margin-top: 15px;
      color: green;
      font-size: 14px;
    }

   
  </style>
</head>
<body>
  <div class="checkin-box">
    
    <!-- âœ…â‘  è¨€èªåˆ‡ã‚Šæ›¿ãˆ -->
    <div class="language-select">
      ğŸŒ 
      <select id="languageSelect" onchange="setLanguage(this.value)">
        <option value="ja">æ—¥æœ¬èª</option>
        <option value="en">English</option>
        <option value="es">EspaÃ±ol</option>
        <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
        <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
      </select>
    </div>

    <h2 id="formTitle">ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³æƒ…å ±</h2>
    <div id="guestInfo">èª­ã¿è¾¼ã¿ä¸­...</div>

    <form id="checkinForm">
      <label id="labelDob">ç”Ÿå¹´æœˆæ—¥:</label>
        <input type="date" name="dob" required>
      

      <label id="labelGender">æ€§åˆ¥:</label>
      <div class="gender-row">
        <label><input type="radio" name="gender" value="M" required> M</label>
        <label><input type="radio" name="gender" value="F"> F</label>
        <label><input type="radio" name="gender" value="Other"> ãã®ä»–</label>
      </div>

      <label id="labelNationality">å›½ç±:</label>
        <select name="nationality" required>
          <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
          <option value="Japan">Japan</option>
          <option value="USA">USA</option>
          <option value="China">China</option>
          <option value="Germany">Germany</option>
          <option value="France">France</option>
        </select>
      

      <label id="labelPrev">å‰æ³Šåœ°:</label>
        <input type="text" name="previousStay" required>
      

      <label id="labelNext">å¾Œæ³Šåœ°:</label>
        <input type="text" name="nextDestination" required>
      

      <button type="submit" id="submitBtn">é€ä¿¡</button>
    </form>
    <p id="message"></p>
  </div>

  <script>
    // âœ…â‘¡ ç¿»è¨³ãƒ‡ãƒ¼ã‚¿
    const translations = {
      ja: {
        formTitle: "ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³æƒ…å ±",
        labelDob: "ç”Ÿå¹´æœˆæ—¥:",
        labelGender: "æ€§åˆ¥:",
        labelNationality: "å›½ç±:",
        labelPrev: "å‰æ³Šåœ°:",
        labelNext: "å¾Œæ³Šåœ°:",
        submit: "é€ä¿¡",
        loading: "èª­ã¿è¾¼ã¿ä¸­...",
        success: "é€ä¿¡ãŒå®Œäº†ã—ã¾ã—ãŸã€‚3ç§’å¾Œã«ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã¸ç§»å‹•ã—ã¾ã™ã€‚",
        fail: "é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚",
        notfound: "äºˆç´„æƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚",
        network: "é€šä¿¡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚"
      },
      en: {
        formTitle: "Check-in Information",
        labelDob: "Date of Birth:",
        labelGender: "Gender:",
        labelNationality: "Nationality:",
        labelPrev: "Previous Stay:",
        labelNext: "Next Destination:",
        submit: "Submit",
        loading: "Loading...",
        success: "Submitted successfully. Redirecting in 3 seconds.",
        fail: "Submission failed.",
        notfound: "Reservation not found.",
        network: "Network error occurred."
      },
      es: {
        formTitle: "InformaciÃ³n de Check-in",
        labelDob: "Fecha de nacimiento:",
        labelGender: "GÃ©nero:",
        labelNationality: "Nacionalidad:",
        labelPrev: "Alojamiento anterior:",
        labelNext: "PrÃ³ximo destino:",
        submit: "Enviar",
        loading: "Cargando...",
        success: "Enviado correctamente. Redirigiendo en 3 segundos.",
        fail: "Error al enviar.",
        notfound: "No se encontrÃ³ la reserva.",
        network: "Error de red."
      },
      "zh-CN": {
        formTitle: "å…¥ä½ä¿¡æ¯",
        labelDob: "å‡ºç”Ÿæ—¥æœŸï¼š",
        labelGender: "æ€§åˆ«ï¼š",
        labelNationality: "å›½ç±ï¼š",
        labelPrev: "å‰ä¸€ä½å®¿åœ°ï¼š",
        labelNext: "ä¸‹ä¸€ç›®çš„åœ°ï¼š",
        submit: "æäº¤",
        loading: "åŠ è½½ä¸­...",
        success: "æäº¤æˆåŠŸã€‚3ç§’åè·³è½¬ä¸»é¡µã€‚",
        fail: "æäº¤å¤±è´¥ã€‚",
        notfound: "æœªæ‰¾åˆ°é¢„è®¢ä¿¡æ¯ã€‚",
        network: "ç½‘ç»œé”™è¯¯ã€‚"
      },
      "zh-TW": {
        formTitle: "å…¥ä½è³‡è¨Š",
        labelDob: "å‡ºç”Ÿæ—¥æœŸï¼š",
        labelGender: "æ€§åˆ¥ï¼š",
        labelNationality: "åœ‹ç±ï¼š",
        labelPrev: "å‰ä¸€ä½å®¿åœ°ï¼š",
        labelNext: "ä¸‹ä¸€ç›®çš„åœ°ï¼š",
        submit: "é€å‡º",
        loading: "è¼‰å…¥ä¸­...",
        success: "å·²é€å‡ºã€‚3ç§’å¾Œè¿”å›é¦–é ã€‚",
        fail: "é€å‡ºå¤±æ•—ã€‚",
        notfound: "æ‰¾ä¸åˆ°é è¨‚è³‡è¨Šã€‚",
        network: "ç¶²è·¯éŒ¯èª¤ã€‚"
      }
    };

    // âœ…â‘¢ è¨€èªé¸æŠãƒ»ä¿æŒãƒ»åæ˜ 
     const params = new URLSearchParams(window.location.search);
    const name = params.get("name");
    const booking = params.get("booking");
    const lang = params.get("lang") || localStorage.getItem("lang") || "ja";

    function applyLanguage(lang) {
      const t = translations[lang];
      document.getElementById("formTitle").innerText = t.formTitle;
      document.getElementById("labelDob").innerText = t.labelDob;
      document.getElementById("labelGender").innerText = t.labelGender;
      document.getElementById("labelNationality").innerText = t.labelNationality;
      document.getElementById("labelPrev").innerText = t.labelPrev;
      document.getElementById("labelNext").innerText = t.labelNext;
      document.getElementById("submitBtn").innerText = t.submit;
      document.getElementById("guestInfo").innerText = t.loading;
      document.getElementById("languageSelect").value = lang;
      localStorage.setItem("lang", lang);
    }

    function setLanguage(lang) {
      applyLanguage(lang);
    }

    applyLanguage(lang);

    const scriptURL = "https://script.google.com/macros/s/AKfycbzt0XjDc0-vbyRlojF2b1JdMOxNuNKijLy0z84vX40HCb8XOg3oW6hZ5PSLERzhSMsGMA/exec";

    fetch(`${scriptURL}?name=${encodeURIComponent(name)}&booking=${booking}&mode=info`)
      .then(res => res.json())
      .then(data => {
        if (data.result === "OK") {
          const checkinDate = data.checkin.split("T")[0];
          const checkoutDate = data.checkout.split("T")[0];
          document.getElementById("guestInfo").innerHTML = `
            <p><strong>åå‰ï¼š</strong>${name}</p>
            <p><strong>äºˆç´„ç•ªå·ï¼š</strong>${booking}</p>
            <p><strong>ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³æ—¥ï¼š</strong>${checkinDate}</p>
            <p><strong>ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆæ—¥ï¼š</strong>${checkoutDate}</p>
            <p><strong>éƒ¨å±‹ã‚¿ã‚¤ãƒ—ï¼š</strong>${data.room}</p>
          `;
        } else {
          document.getElementById("guestInfo").innerText = translations[lang].notfound;
        }
      })
      .catch(() => {
        document.getElementById("guestInfo").innerText = translations[lang].network;
      });

    document.getElementById("checkinForm").addEventListener("submit", function (e) {
      e.preventDefault();
      const formData = new FormData(e.target);
      formData.append("name", name);
      formData.append("booking", booking);

      fetch(scriptURL, {
        method: "POST",
        body: formData,
      })
        .then((res) => res.text())
        .then((res) => {
          if (res === "RECEIVED") {
            document.getElementById("message").innerText = translations[lang].success;
            setTimeout(() => {
              window.location.href = "https://wiseowlhostels.com/kyoto/";
            }, 3000);
          } else {
            document.getElementById("message").innerText = translations[lang].fail;
          }
        })
        .catch(() => {
          document.getElementById("message").innerText = translations[lang].network;
        });
    });
  </script>
</body>
</html>
